"""
Базовый класс для форматеров актов.

Определяет общий интерфейс для всех форматеров,
обеспечивая единообразие API.
"""

from abc import ABC, abstractmethod
from typing import Union

from docx import Document


class BaseFormatter(ABC):
    """
    Абстрактный базовый класс для форматеров актов.

    Все форматеры должны наследоваться от этого класса
    и реализовывать метод format().
    """

    @abstractmethod
    def format(self, data: dict) -> Union[str, Document]:
        """
        Форматирует данные акта в целевое представление.

        Этот метод должен быть переопределен в дочерних классах
        для реализации конкретной логики форматирования.

        Args:
            data: Данные акта для форматирования (словарь с деревом, таблицами и т.д.)

        Returns:
            Union[str, Document]: Отформатированный результат.
                Строка для текстовых форматов (txt, md),
                Document для бинарных форматов (docx).

        Raises:
            NotImplementedError: Если метод не переопределен
        """
        pass
