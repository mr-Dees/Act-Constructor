/*
 * Состояния элементов дерева
 * Стили для выбранных, защищенных и редактируемых элементов
 */

/* ВАЖНО: Защищенный элемент должен быть желтым */
.tree-item.protected {
    background: var(--tree-protected-bg) !important;
    border-left: 3px solid var(--warning);
    color: var(--text-primary);
    position: relative;
    box-shadow: var(--shadow-sm);
}

/* Обычный выбранный элемент (белый фон по умолчанию) */
.tree-item.selected {
    background: var(--tree-node-bg-selected);
    color: var(--primary);
    border-color: var(--tree-node-border-selected);
    box-shadow: var(--shadow-lg);
    font-weight: var(--font-weight-medium);
    z-index: calc(var(--z-base) + 1);
}

/* Защищенный + выбранный = желтый фон сохраняется */
.tree-item.protected.selected {
    background: var(--tree-protected-bg) !important;
    color: var(--primary);
    border-left: 3px solid var(--warning);
    border-color: var(--tree-node-border-selected);
    box-shadow: var(--shadow-lg);
    font-weight: var(--font-weight-medium);
}

/* Сильное выделение для обычных элементов */
.tree-item.selected.strong {
    background: var(--primary);
    color: var(--text-on-primary);
    border-color: var(--primary);
    box-shadow: var(--shadow-xl);
}

/* Сильное выделение для защищенных элементов */
.tree-item.protected.selected.strong {
    background: var(--warning-subtle) !important;
    color: var(--text-primary);
    border-left: 3px solid var(--warning);
    box-shadow: var(--shadow-xl);
}

/* Родительский элемент выбранного узла */
.tree-item.parent-selected {
    background: var(--tree-node-bg-selected);
    color: var(--primary);
    border-color: var(--tree-node-border-selected);
    box-shadow: var(--shadow-lg);
    font-weight: var(--font-weight-medium);
}

/* Защищенный родительский элемент */
.tree-item.protected.parent-selected {
    background: var(--tree-protected-bg) !important;
    color: var(--primary);
    border-left: 3px solid var(--warning);
    border-color: var(--tree-node-border-selected);
    box-shadow: var(--shadow-lg);
    font-weight: var(--font-weight-medium);
}

/* Элемент в режиме редактирования */
.tree-item.editing .tree-label {
    background: var(--input-bg);
    border: 2px solid var(--input-border-focus);
    border-radius: var(--radius-sm);
    outline: none;
    color: var(--input-text) !important;
    padding: var(--spacing-xs) var(--spacing-sm);
    box-shadow: var(--input-shadow-focus);
    min-width: 8rem;
}

/* Анимация перехода в режим редактирования */
.tree-item.editing {
    animation: editingPulse 0.3s ease-out;
    box-shadow: var(--shadow-lg) !important;
}

/* Скрытие дочерних элементов свернутого узла */
.tree-item.collapsed > .tree-children {
    display: none;
}

/* Анимация разворачивания */
.tree-children.expanding {
    animation: slideDown var(--transition-base);
}

/* Отключенный элемент */
.tree-item.disabled {
    opacity: 0.5;
    cursor: not-allowed;
    pointer-events: none;
}

/* Элемент с ошибкой валидации */
.tree-item.error {
    border-color: var(--error);
    background: var(--error-subtle);
    box-shadow: var(--shadow-md);
}

.tree-item.error::after {
    content: '⚠';
    position: absolute;
    right: var(--spacing-sm);
    top: 50%;
    transform: translateY(-50%);
    color: var(--error);
    font-size: var(--font-size-sm);
}

/* Временная подсветка (например, после вставки) */
.tree-item.highlight {
    animation: highlightFlash 1.2s ease-out;
}
