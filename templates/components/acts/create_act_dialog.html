<!-- templates/components/acts/create_act_dialog.html -->
<template id="createActDialogTemplate">
    <div class="custom-dialog-overlay">
        <div class="custom-dialog acts-modal">
            <div class="acts-modal-header">
                <h3 class="dialog-title" data-field="title"></h3>
                <button type="button" class="acts-modal-close" aria-label="Закрыть">
                    &times;
                </button>
            </div>
            <form id="actForm" autocomplete="off">
                <label>
                    Наименование проверки *
                    <input type="text" name="inspection_name" required data-field="inspection_name">
                </label>

                <label>
                    Город *
                    <input type="text" name="city" required data-field="city">
                </label>

                <label>
                    Дата составления
                    <input type="date" name="created_date" data-field="created_date">
                </label>

                <label>
                    Номер приказа *
                    <input type="text" name="order_number" required data-field="order_number">
                </label>

                <label>
                    Дата приказа *
                    <input type="date" name="order_date" required data-field="order_date">
                </label>

                <label>
                    Срок проверки: начало *
                    <input type="date" name="inspection_start_date" required data-field="inspection_start_date">
                </label>

                <label>
                    Срок проверки: окончание *
                    <input type="date" name="inspection_end_date" required data-field="inspection_end_date">
                </label>

                <label id="kmNumberField">
                    КМ номер *
                    <input type="text"
                           name="km_number"
                           data-field="km_number"
                           placeholder="КМ-__-____"
                           pattern="КМ-\d{2}-\d{4}"
                           title="Формат: КМ-XX-XXXX (например, КМ-75-9475)"
                           required>
                    <small class="field-hint">Формат: КМ-XX-XXXX (например, КМ-75-9475). Поле можно
                        редактировать.</small>
                </label>

                <div class="act-parts-grid">
                    <label>
                        <span id="partNumberLabel">Часть акта (автоматически)</span>
                        <input type="number"
                               name="part_number"
                               data-field="part_number"
                               min="1"
                               value="1"
                               required
                               readonly>
                    </label>
                    <label>
                        <span id="totalPartsLabel">Всего частей (автоматически)</span>
                        <input type="number"
                               name="total_parts"
                               data-field="total_parts"
                               min="1"
                               value="1"
                               required
                               readonly>
                    </label>
                </div>

                <label class="checkbox-label">
                    <input type="checkbox" name="is_process_based" data-field="is_process_based">
                    <span>Процессная проверка</span>
                </label>

                <fieldset>
                    <legend>Состав аудиторской группы *</legend>
                    <div id="auditTeamContainer"></div>
                    <button type="button" id="addTeamMemberBtn" class="btn btn-secondary btn-add-item">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                            <path d="M12 5V19M5 12H19" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                        </svg>
                        Добавить члена группы
                    </button>
                </fieldset>

                <!-- Служебная записка: показывается только при редактировании -->
                <fieldset id="serviceNoteFieldset" class="service-note-section" style="display: none;">
                    <legend>Служебная записка (опционально)</legend>

                    <label>
                        Номер служебной записки
                        <input type="text"
                               name="service_note"
                               data-field="service_note"
                               placeholder="ЦМ-75-вн/9475"
                               pattern=".+/\d{4}"
                               title="Формат: Текст/XXXX (например, ЦМ-75-вн/9475)">
                        <small class="field-hint">При указании СЗ часть акта определяется последними 4 цифрами
                            записки</small>
                    </label>

                    <label>
                        Дата служебной записки
                        <input type="date"
                               name="service_note_date"
                               data-field="service_note_date">
                    </label>
                </fieldset>

                <!-- Действующие поручения: показывается только при редактировании -->
                <fieldset id="directivesFieldset" style="display: none;">
                    <legend>Действующие поручения</legend>
                    <div id="directivesContainer"></div>
                    <button type="button" id="addDirectiveBtn" class="btn btn-secondary btn-add-item">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                            <path d="M12 5V19M5 12H19" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                        </svg>
                        Добавить поручение
                    </button>
                </fieldset>

                <div class="dialog-actions">
                    <button type="submit" class="btn btn-primary" data-field="submitText"></button>
                    <button type="button" class="btn btn-secondary dialog-cancel">Отмена</button>
                </div>
            </form>
        </div>
    </div>
</template>
